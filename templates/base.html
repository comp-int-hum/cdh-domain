{% load sekizai_tags static %}
{% load guardian_tags %}
{% load cdh %}

{% cdh_get_documentation_object view_name item as doc_info %}
{% get_obj_perms request.user for doc_info.object as "doc_perms" %}


<!doctype html>
<html lang="en" >
  <head>

    {% addtoblock "css" %}
    <link rel='stylesheet' id='bootstrap-css'  href="{% static 'bootstrap/dist/css/bootstrap.min.css' %}" type='text/css' />
    <link rel='stylesheet' id='main-stylesheet-css'  href="{% static 'cdh/css/cdh.css' %}" type='text/css' media='all' />
    <link rel='stylesheet' id='main-stylesheet-css'  href="{% static 'monaco/min/vs/editor/editor.main.css' %}" type='text/css' media='all' />    
    {% endaddtoblock %}
    
    {% render_block "css" %}
    
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />    
    <meta name="date" content="September 25, 2022" />        
    <link rel="icon" href="{% static 'cdh/img/favicon.png' %}">

    {% addtoblock "initial_js" %}
    <script type='text/javascript' src="{% static 'modernizr/modernizr.js' %}" id='theme-modernizr-js'></script>
    <script type='text/javascript' src="{% static 'jquery/dist/jquery.min.js' %}" id='jquery-core-js'></script>
    <script type='text/javascript' src="{% static 'jquery.cookie/jquery.cookie.js' %}" id='theme-cookie-js'></script>
    <script type='text/javascript' src="{% static 'jquery.scrollTo/jquery.scrollTo.js' %}" id='theme-scrollto-js'></script>
    <script type='text/javascript' src="{% static 'vega/docs/vega.min.js' %}" id='vega'></script>
    <script type='text/javascript' src="{% static 'cdh/js/hyperscript.min.js' %}" id="hyperscript"></script>
    <script type='text/javascript' src="{% static 'cdh/js/htmx.min.js' %}" id='htmx'></script>    
    {% endaddtoblock %}
    
    {% render_block "initial_js" %}    
    <title>Center for Digital Humanities | Johns Hopkins University</title>
    <meta name='robots' content='max-image-preview:large' />
    <meta property="og:title" content="Home | CDH"/>
    <meta property="og:description" content="The Johns Hopkins University Center for Digital Humanities"/>
    <meta property="og:type" content="article"/>
    <meta property="og:url" content="https://cdh.jhu.edu/"/>
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@comp_hum" />
    <meta property="og:site_name" content="Center for Digital Humanities"/>
    <meta name="facebook-domain-verification" content="s1lj448peh4wqw24bgcc5f2t6n23tc" />
    
    {% block extra_head %}
    {{ block.super }}
    {% endblock %}
    {% block extrahead %}
    {{ block.super }}
    {% endblock %}    
    {% block extrastyle %}
    {{ block.super }}
    {% endblock %}
    {% block extra_style %}
    {{ block.super }}
    {% endblock %}
  </head>

  <body>

    
      <header class="site-header" role="banner" aria-labelledby="dept-info">
	
	<div class="roof-header-top hide-for-print">
	  <div class="row align-justify">
	    <div class="roof-header-top-links">
	      <ul class="menu simple roof-menu align-right">
		<li>
		  {% if request.user.is_authenticated %}
		  <a
		    href="/accounts/logout?next={{request.path_info}}"
		    title="Log out as {{request.user.first_name}} {{request.user.last_name}}"
		    >
		    <svg
		      xmlns="http://www.w3.org/2000/svg"
		      width="32"
		      height="32"
		      fill="white"
		      class="bi bi-door-open"
		      viewBox="0 0 16 16"
		      >
		      <path
			d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1z"
			/>
		      <path
			d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117zM11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5zM4 1.934V15h6V1.077l-6 .857z"
			/>
		    </svg>
		  </a>
		  {% else %}
		  <a
		    href="/accounts/login?next={{request.path_info}}"
		    title="Log in or create an account"
		    >
		    <svg
		      xmlns="http://www.w3.org/2000/svg"
		      width="32"
		      height="32"
		      fill="white"
		      class="bi bi-door-closed"
		      viewBox="0 0 16 16"
		      >
		      <path
			d="M3 2a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v13h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V2zm1 13h8V2H4v13z"
			/>
		      <path
			d="M9 9a1 1 0 1 0 2 0 1 1 0 0 0-2 0z"
			/>
		    </svg>
		  </a>
		  {% endif %}
		</li>
		<li>
		  <a
		    href="/wiki/help"
		    title="Help and documentation"
		    >
		    <svg
		      xmlns="http://www.w3.org/2000/svg"
		      width="32"
		      height="32"
		      fill="white"
		      class="bi bi-question-circle"
		      viewBox="0 0 16 16"
		      >
		      <path
			d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"
			/>
		      <path
			d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"
			/>
		    </svg>
		  </a>
		</li>
	      </ul>
	    </div>
	  </div>
	</div>

	<div class="small-site-holder">
	  <div class="site-information hide-for-print">
	    <div class="nav-shield">
	      <a href="https://jhu.edu/" rel="home">
		<div class="white">
		  <img width="200" height="56" src="{% static 'cdh/img/jhu-logo.svg' %}" alt="JHU Shield">-
		</div>
	      </a>
	    </div>
	    <div class="site-desktop-title">
	      <div class="top-bar-title">
		<h1>
		  <a id="index-link" href="/">
		    <small>Center for</small> Digital Humanities
		  </a>
		</h1>
	      </div>
	    </div>
	  </div>
	</div>

	<nav class="top-bar main-navigation navbar-toggler" aria-label="Main Menu" style="z-index:10">
	<ul class="nav nav-tabs menu">
	  {% for k, v in builtin_pages.items %}
	  <li class="nav-item">
	    <a class="nav-link {% if top_level == k %}active{% endif %}" href="/{{k}}/">
	      {{v}}
	    </a>
	  </li>
	  {% endfor %}
	  

	  <li class="nav-item dropdown">
	    <a class="nav-link dropdown-toggle {% if top_level in apps or top_level == 'manage' %}active{% endif %}" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
	      Interaction{% if top_level in apps or top_level == 'api' %}[{{ interaction_name }}]{% endif %}
	    </a>
	    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
	      {% for k, v in apps.items %}
	      <li>
		<a class="dropdown-item {% if top_level == k %}active{% endif %}" href="/{{k}}/">
		  {{v}}
		</a>
	      </li>
	      {% endfor %}
	      {% if request.user.is_authenticated %}
	      <li>
		<a class="dropdown-item {% if top_level == 'api' %}active{% endif %}" href="/api/">
		  API
		</a>
	      </li>
	      {% endif %}
	      {% comment %}
	      {% if is_admin %}
	      <li>
		<hr class="dropdown-divider">
	      <li>
	      <li>
		<a class="dropdown-item {% if top_level == 'manage' %}active{% endif %}" href="/manage">
		  Manage
		</a>
	      </li>
	      {% endif %}
	      {% endcomment %}
	    </ul>
	  </li>

	</ul>
	</nav>
      </header>


      {% block modals %}
      {{ block.super }}
      {% endblock %}
      {% render_block "modals" %}

      
      <div class="container mt-4">
	<div class="grid-with-gutters">
	  <div class="row">
	    {% block breadcrumbs %}
	    {% if breadcrumbs|length > 0 %}	    
	    <nav aria-label="breadcrumb">
	      <ol class="breadcrumb">
		{% for name, path, args in breadcrumbs %}
		{% if forloop.last %}
		<li class="breadcrumb-item"><b>{{name}}</b></li>
		{% else %}
		{% if args %}
		<li class="breadcrumb-item"><a href="{% url path args %}">{{name}}</a></li>
		{% else %}
		<li class="breadcrumb-item"><a href="{% url path %}">{{name}}</a></li>
		{% endif %}
		{% endif %}
		{% endfor %}
	      </ol>
	    </nav>
	    {% endif %}
	    {% endblock %}
	    {% if messages %}
	    <ul class="messages">
	      {% for message in messages %}
	      <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
	      {% endfor %}
	    </ul>
	    {% endif %}	    
	    <div id="top_level_content" class="container">
	      {% block content %}{% endblock %}
	      {% block body %}{% endblock %}
	    </div>
	  </div>
	</div>
      </div>

      <div id="to-preserve" hx-preserve="1">
      {% block js %}{{block.super}}{% endblock %}
      
      {% addtoblock "js" %}
      <script type='text/javascript' src="{% static 'cdh/js/jquery.breakpoints.js' %}" id='theme-breakpoints-js'></script>
      <script type='text/javascript' src="{% static 'bootstrap/dist/js/bootstrap.bundle.min.js' %}" id='theme-bootstrap-js'></script>
      <script type='text/javascript' src="{% static 'monaco/min/vs/loader.js' %}" id='monaco-js'></script>
      <script type='text/javascript' src="{% static 'cdh/js/cdh.js' %}" id='cdh-js'></script>
      {% endaddtoblock %}
      
      {% render_block "js" %}

      {% block finaljs %}{{block.super}}{% endblock %}

      {% render_block "finaljs" %}

      <script>
	cdhSetup(document.body, false);
	//window.onbeforeunload = saveState;
	
	htmx.on("htmx:load", function(evt) {
	    cdhSetup(evt.detail.elt, true);
	    //evt.target.scrollIntoView(true);

	});
	document.body.addEventListener("cdhEvent", handleCdhEvent);
	
	// window.addEventListener("load", (event) => {
	//     var pathName = document.location.pathname;
	//     if (sessionStorage["scrollPosition_" + pathName]) {
	// 		    console.error("test");

	// 	$(document).scrollTop(sessionStorage.getItem("scrollPosition_" + pathName));
	//     }
	// });

      </script>
      </div>
  </body>
</html>
